/*
SK通用表单验证插件
SkValidForm version 1.1
By seven, during May 29, 2015- June 1, 2015
For more information, please visit http://bbs.sk-school.com
SkValidForm is available under the terms of the MIT license. */

(function($){var config={"isClear":1,"isFocus":1,"isShowRight":0,"tipsmsgFadeTime":800,"tipsStyle1Time":3,"tipsStyle1Wh":10,"tipsStyle1Style1Fx":40,};var ruleType={"isEq":"isEq","isEmpty":"isEmpty","select":"select","radio":"radio","checkbox":"checkbox","account":/^[a-zA-Z][a-zA-Z0-9_]{5,15}$/,"pwd":/^.{6,18}$/,"email":/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,"isChinese":/^[\u4e00-\u9fa5]{6,10}$/,"isQq":/^[1-9][0-9]{5,}$/,"isInt1":/^\d+$/,"isInt2":/^[0-9]*[1-9][0-9]*$/,};var skSetTimeout;var methods={tipsStyle1:function(options,status,configs){var configs=JSON.parse(configs);var options=JSON.parse(options);$(options.node).css("border","solid 1px #e6e6e6");if(!status){$.skTools.flash(options.node,configs.tipsStyle1Time,configs.tipsStyle1Wh,configs.tipsStyle1Style1Fx,configs,options,status)}else{if(status==3){$(options.node).css({"border":"solid 1px #0cafec"})}else{$(options.node).after("<span class='sk-error-tip flashClass'><em class='error-ico'>&nbsp;</em><span class='error-msg'>"+options.errmsg+"</span></span>");$.skTools.flash(options.node,configs.tipsStyle1Time,configs.tipsStyle1Wh,configs.tipsStyle1Style1Fx,configs,options,status)}}},tipsStyle2:function(options,status,configs){$(".flashClass").remove();clearTimeout(skSetTimeout);var configs=JSON.parse(configs);var options=JSON.parse(options);$(options.node).parents("p").find(".right2").remove();if(!status){$(options.node).parent("p").append("<span class='flashClass err2'>"+options.errmsg+"</span>")}else{if(status==3){$(options.node).parent("p").append("<span class='right2'>&nbsp;</span>")}else{$(options.node).after("<span class='flashClass err2'>"+options.errmsg+"</span>")}}$.skTools.fadeTimeAct(options,status,configs)},tipsStyle3:function(){},beforeSubmit:function(options){},err1:function(options){if(options==""){options="null"}alert("Parameter configuration errors, node："+options+" on jQuery.skValidForm");return},err2:function(){alert("Method does not exist on jQuery.skValidForm");return},};$.skTools={show:function(param){$(param).css("display","block");return},hide:function(param){$(param).css("display","none");return},print:function(param){console.info(param);return},flash:function(obj,time,wh,fx,configs,options,status){$(function(){var $panel=$(obj);var offset=$panel.offset()-$panel.width();var x=offset.left;var y=offset.top;var $panelTip=$(obj).next(".sk-error-tip");var offsetTip=$panelTip.offset()-$panelTip.width();var xTip=offsetTip.left;var yTip=offsetTip.top;for(var i=1;i<=time;i++){if(i%2==0){$panel.animate({left:"+"+wh+"px"},fx);$panelTip.animate({left:"+"+wh+"px"},fx)}else{$panel.animate({left:"-"+wh+"px"},fx);$panelTip.animate({left:"-"+wh+"px"},fx)}}$panel.animate({left:"0px"},fx);$panel.offset({top:y,left:x});$panelTip.animate({left:"0px"},fx);$panelTip.offset({top:yTip,left:xTip});$.skTools.fadeTimeAct(options,status,configs)})},fadeTimeAct:function(options,status,configs){if(configs.tipsmsgFadeTime){skSetTimeout=setTimeout(function(){if(options.ruleType!="radio"&&options.ruleType!="checkbox"&&configs.isClear==1){$(".flashClass").prev("input").val("");$(".flashClass").prev("textarea").html("")}$(".flashClass").remove()},configs.tipsmsgFadeTime)}if(options.ruleType!="radio"&&options.ruleType!="checkbox"&&configs.isClear==1){$(".flashClass").prev("input").val("");$(".flashClass").prev("textarea").html("")}if(configs.isFocus){$(options.node).focus()}},style1Error:function(node,msg,configs){methods.tipsStyle1(JSON.stringify({node:node,ruleType:"",errmsg:msg}),1,JSON.stringify(configs));return},style2Error:function(node,msg,configs){methods.tipsStyle2(JSON.stringify({node:node,ruleType:"",errmsg:msg}),1,JSON.stringify(configs));return}};$.extend({skValidForm:function(options){if(typeof options==="object"){var configs=$.extend({},config,options.config);var settings=$.extend({},ruleType,options.ruleType);var ruleAdd=options.ruleAdd;var tipsStyle=(options.tipsStyle==""||!options.tipsStyle)?"tipsStyle1":options.tipsStyle;for(var i=0;i<ruleAdd.length;i++){if(ruleAdd[i]["node"]==""||ruleAdd[i]["ruleType"]==""){methods.err1(ruleAdd[i]["node"]);return}var val=$(ruleAdd[i]["node"]).val();if(ruleAdd[i]["ruleType"]=="radio"||ruleAdd[i]["ruleType"]=="checkbox"){val=$(ruleAdd[i]["node"]+":checked").val()}if(ruleAdd[i]["ruleType"]=="select"){val=$(ruleAdd[i]["node"]).val()}if(val==""||typeof val=="undefined"){eval("methods."+tipsStyle+"('"+JSON.stringify(ruleAdd[i])+"',0,'"+JSON.stringify(configs)+"')");return}if(ruleAdd[i]["ruleType"]=="isEq"){if(ruleAdd[i]["node2"]==""){methods.err1(ruleAdd[i]["node"]);return}var val2=$(ruleAdd[i]["node2"]).val();if(val!=val2){eval("methods."+tipsStyle+"('"+JSON.stringify(ruleAdd[i])+"',1,'"+JSON.stringify(configs)+"')");return}}if(ruleAdd[i]["ruleType"]!="isEq"&&ruleAdd[i]["ruleType"]!="isEmpty"&&ruleAdd[i]["ruleType"]!="select"&&ruleAdd[i]["ruleType"]!="radio"&&ruleAdd[i]["ruleType"]!="checkbox"){var reg=new RegExp(settings[ruleAdd[i]["ruleType"]]);if(val==""){eval("methods."+tipsStyle+"('"+JSON.stringify(ruleAdd[i])+"',0,'"+JSON.stringify(configs)+"')");
return}else{if(!reg.test(val)){eval("methods."+tipsStyle+"('"+JSON.stringify(ruleAdd[i])+"',1,'"+JSON.stringify(configs)+"')");return}}}if(ruleAdd[i]["ajaxPost"]==1&&$(ruleAdd[i]["node"]).attr("isValid")!=1){if(ruleAdd[i]["ajaxUrl"]==""||typeof ruleAdd[i]["ajaxData"]!=="object"){methods.err1(ruleAdd[i]["node"]+" ajax");return}var ajaxStatus=1;var ajaxNode=ruleAdd[i]["node"];$.ajax({type:"POST",async:false,url:ruleAdd[i]["ajaxUrl"],data:ruleAdd[i]["ajaxData"],dataType:"json",success:function(data){if(data.status){$(ajaxNode).attr("isValid",1)}else{eval("methods."+tipsStyle+"('"+JSON.stringify({node:ajaxNode,errmsg:data.msg})+"',1,'"+JSON.stringify(configs)+"')");ajaxStatus=0;return}},error:function(){eval("methods."+tipsStyle+"('"+JSON.stringify({node:ruleAdd[i]["node"],errmsg:"errCode 500"})+"',1,'"+JSON.stringify(configs)+"')");ajaxStatus=0;return}});if(!ajaxStatus){return}}if(configs.isShowRight){eval("methods."+tipsStyle+"('"+JSON.stringify(ruleAdd[i])+"',3,'"+JSON.stringify(configs)+"')")}}options.beforeSubmit(configs);return}else{methods.err2();return}}})})(jQuery);